# Agentic Social Simulator

An **AI-powered social networking simulator** where you build a persona from a voice interview, chat with an AI (Claude), and watch multi-agent group conversationsâ€”including a **General** tab that replays or streams conversations (e.g. from [Agentic_social_gaurav](https://github.com/GauravAtavale/Agentic_social)) with configurable pauses between messages.

---

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Project Structure](#project-structure)
- [Setup](#setup)
- [Running the App](#running-the-app)
- [Voice Interview (Persona Building)](#voice-interview-persona-building)
- [Backend API](#backend-api)
- [General Tab Streaming](#general-tab-streaming)
- [Environment Variables](#environment-variables)
- [Tech Stack](#tech-stack)
- [Credits & References](#credits--references)

---

## Overview

Agentic Social lets you:

1. **Create a profile** via a questionnaire and an in-app **voice interview** (ElevenLabs TTS/STT)â€”no file uploads.
2. **Chat in the Human tab** with Claude; messages and emoji reactions are persisted.
3. **Open the General tab** to stream a multi-agent conversation: either **replay** an existing `conversational_history.txt` (e.g. from `Agentic_social_gaurav`) with a 4â€“5 second pause between messages, or **generate** new turns via Anthropic Claude using Gaurav-style bidding and personas.
4. **Browse Sports, AI, Tech** (and optional dynamic topics) for pre-generated group conversations.
5. **View matches** and send connection requests from the sidebar.

The backend is a **FastAPI** server that serves the API and a simple static frontend. Personas are stored as JSON; conversations can be generated from personas or replayed from a history file.

---

## Features

| Feature | Description |
|--------|-------------|
| **Profile creation** | Questionnaire + in-app voice interview; persona extracted via Claude and saved under `backend/personas/`. |
| **Human chat** | One-on-one chat with Claude; messages have IDs and emoji reactions (ğŸ‘â¤ï¸ğŸ˜‚ğŸ”¥). |
| **General tab** | On open: if `Agentic_social_gaurav/conversational_history.txt` exists, **replays** every message with a 5s (configurable) pause; otherwise can **generate** multi-agent turns (Gaurav-style bidding + Claude streaming). |
| **Sports / AI / Tech** | Pre-generated group conversations (from `generate_conversations.py`) and optional dynamic topics (e.g. Finance, Politics). |
| **Matches** | Sidebar shows matches; click to view profile and send connection requests. |
| **Voice interview (root)** | Standalone script: questions spoken via ElevenLabs, answers recorded and transcribed; saved to `convN.json` and `conversation_audio_N/`. |

---

## Project Structure

```
Agentic_social/
â”œâ”€â”€ README.md                 # This file
â”œâ”€â”€ .env                      # Root: ELEVENLABS_API_KEY (for voice interview)
â”œâ”€â”€ .gitignore
â”œâ”€â”€ QUESTIONS.md              # Questions used in voice interview
â”œâ”€â”€ requirements.txt         # Root deps: elevenlabs, python-dotenv, sounddevice, etc.
â”œâ”€â”€ run_questions.py         # Voice Q&A: TTS questions, record + STT answers â†’ convN.json
â”œâ”€â”€ Conversations/            # Optional: conv1.json, conv2.json, ... (interview outputs)
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ .env                  # ANTHROPIC_API_KEY, ELEVENLABS_API_KEY (optional)
â”‚   â”œâ”€â”€ main.py               # FastAPI app: API + static frontend; General stream/replay
â”‚   â”œâ”€â”€ create_persona.py     # Extract persona JSON from interview/conversation
â”‚   â”œâ”€â”€ generate_conversations.py  # Generate Sports/AI/Tech conversations + matches
â”‚   â”œâ”€â”€ requirements.txt     # fastapi, uvicorn, anthropic, python-dotenv, pydantic, elevenlabs
â”‚   â”œâ”€â”€ personas/             # Persona JSON files (from create_persona or profile flow)
â”‚   â”œâ”€â”€ conversations/       # sports.json, ai.json, tech.json, human.json, general.json
â”‚   â”œâ”€â”€ interviews/           # Optional interview JSON inputs
â”‚   â”œâ”€â”€ matches.json          # Generated by generate_conversations.py
â”‚   â”œâ”€â”€ profile.json          # Current user profile
â”‚   â”œâ”€â”€ connection_requests.json
â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”œâ”€â”€ index.html        # Main app: tabs (Human, General, Sports, AI, Tech), matches, chat
â”‚   â”‚   â”œâ”€â”€ app.js            # Load chat, General stream consumer, human form, reactions
â”‚   â”‚   â”œâ”€â”€ styles.css
â”‚   â”‚   â”œâ”€â”€ profile.html      # Questionnaire + in-app voice interview + â€œCreate my personaâ€
â”‚   â”‚   â”œâ”€â”€ profile.js
â”‚   â”‚   â””â”€â”€ profile.css
â”‚   â””â”€â”€ README.md             # Backend-specific setup and API summary
â”‚
â””â”€â”€ Agentic_social_gaurav/    # Optional: reference repo with conversational_history.txt
    â”œâ”€â”€ conversational_history.txt   # Used by General tab replay (one JSON per line or "} {")
    â””â”€â”€ Personal_builder/      # Persona prompts, sys_prompt.txt (for generate mode)
```

---

## Setup

### 1. Clone and install root dependencies (voice interview)

```bash
git clone https://github.com/GauravAtavale/Agentic_social.git
cd Agentic_social
pip install -r requirements.txt
cp .env.example .env   # or create .env with ELEVENLABS_API_KEY
```

### 2. Backend

```bash
cd backend
pip install -r requirements.txt
```

Create `backend/.env` (see [Environment Variables](#environment-variables)).

### 3. Optional: General tab replay

To **replay** an existing conversation when you open the General tab, ensure:

- The repo includes a sibling folder **`Agentic_social_gaurav`** (or you create it), and  
- Inside it, a file **`conversational_history.txt`** with one JSON object per line (or multiple per line separated by `} {`), e.g.:

```text
{"role": "Anagha", "content": "Hi, who are you?"}
{"role": "Gaurav", "content": "Hi Anagha, I'm Gaurav..."}
```

The backend reads this file and streams each message with a **5 second** (configurable) pause between messages. No API calls are made in replay mode.

---

## Running the App

### Start the backend (API + frontend)

```bash
cd backend
uvicorn main:app --reload
```

- **App:** [http://localhost:8000](http://localhost:8000)  
- **Profile / Create persona:** [http://localhost:8000/profile](http://localhost:8000/profile)  
- **API docs:** [http://localhost:8000/docs](http://localhost:8000/docs)  
- **Health:** [http://localhost:8000/health](http://localhost:8000/health)

### Run the voice interview (standalone)

From the **project root** (not `backend/`):

```bash
python run_questions.py
```

Youâ€™ll be asked for a session number (e.g. 1â€“4). Questions are spoken via ElevenLabs; you answer by voice and press Enter when done. Outputs: `convN.json` and `conversation_audio_N/` (or `conversation.json` / `conversation_audio/` depending on script version).

---

## Voice Interview (Persona Building)

- **Questions** are defined in `QUESTIONS.md` (list items with `- `).
- **Flow:** Each question is played with ElevenLabs TTS â†’ you speak â†’ recording stops on Enter â†’ audio is sent to ElevenLabs STT â†’ Q&A is appended to the conversation JSON and saved.
- **Output:** e.g. `conv1.json`, `conv2.json`, â€¦ and optional `conversation_audio_1/`, etc.
- You can then use the **Profile** page in the app (questionnaire + in-app voice interview) and â€œCreate my personaâ€, or feed interview JSON into `backend/create_persona.py` to produce a persona in `backend/personas/`.

---

## Backend API

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/health` | Health check |
| GET | `/` | Main app (index.html) |
| GET | `/profile` | Profile / questionnaire / voice interview / create persona |
| GET | `/api/conversations/{group}` | Get conversation for `human`, `general`, `sports`, `ai`, `tech`, or dynamic topic |
| GET | `/api/conversations/general/stream?turns=10&pause_seconds=5` | **SSE stream:** replay or generate General chat; `pause_seconds` between messages (default 5) |
| POST | `/api/conversations/human` | Send human message (body: `{"speaker","text"}`); Claude reply appended |
| POST | `/api/conversations/human/react` | Add emoji reaction (body: `{"message_id", "emoji"}`) |
| DELETE | `/api/conversations/human` | Clear human chat |
| GET | `/api/matches` | Match list |
| GET | `/api/personas` | All personas |
| POST | `/api/create-persona` | Create persona from profile + optional conversation |
| POST | `/api/connection-requests` | Send connection request (body: `{"to": "Name"}`) |
| GET | `/api/profile` | Current user profile |
| POST | `/api/profile` | Save profile |
| GET | `/api/questions` | Questions for in-app voice interview |
| POST | `/api/transcribe` | Transcribe audio (body: `{"audio_base64": "..."}`) |

---

## General Tab Streaming

When you **click the General tab**:

1. The frontend calls **`GET /api/conversations/general/stream?turns=10&pause_seconds=5`**.
2. **If `Agentic_social_gaurav/conversational_history.txt` exists:**  
   The backend **replays** that file: it parses each message (supports multiple JSONs per line separated by `} {`) and sends Server-Sent Events (SSE):
   - `message_start` (speaker)
   - `chunk` (full message text)
   - `message_end` (speaker, text)
   - Then **sleeps 5 seconds** (or `pause_seconds`) before the next message.  
   **No Anthropic API is called** in this mode.
3. **Else** (no history file but Gaurav folder exists):  
   The backend can **generate** new turns using Gaurav-style logic (credits, bidding, persona prompts) and **Anthropic Claude** streaming, with a pause between each turn.
4. **Else:**  
   Fallback to the built-in multi-persona General generator (round-robin personas, Claude).

The frontend consumes the SSE stream and appends message bubbles in real time; on `message_end` it sets the full text so the message is always visible.

---

## Environment Variables

| Variable | Where | Purpose |
|----------|--------|---------|
| `ELEVENLABS_API_KEY` | Root `.env` | Voice interview (run_questions.py): TTS and STT |
| `ANTHROPIC_API_KEY` | `backend/.env` | Human chat replies, General tab generation, persona extraction, create_persona |
| `ELEVENLABS_API_KEY` | `backend/.env` (optional) | In-app voice interview and TTS/STT on profile page |

The backend loads **`backend/.env`** on startup via `python-dotenv` so `ANTHROPIC_API_KEY` is available for all API and streaming logic.

---

## Tech Stack

- **Root:** Python 3, ElevenLabs (TTS/STT), sounddevice, soundfile, python-dotenv  
- **Backend:** FastAPI, Uvicorn, Anthropic (Claude), Pydantic, python-dotenv, ElevenLabs (optional)  
- **Frontend:** Vanilla HTML/CSS/JS, served by FastAPI static mount  
- **Streaming:** Server-Sent Events (SSE) for General tab; fetch + ReadableStream on the client  

---

## Credits & References

- **Agentic_social_gaurav:** Multi-agent conversation format, persona prompts, and `conversational_history.txt` style (see [Agentic_social_gaurav](https://github.com/GauravAtavale/Agentic_social) or sibling folder). The General tab can **replay** that file with a 4â€“5 second interval between messages or use similar bidding/persona logic with Claude.
- **Proxy AI:** Backend design (personas, conversations, matches, human chat) and static frontend structure.
